# Мастерская BigData PySpark ChicagoTaxiDispatch

## Описание задачи:
В нашем распоряжении данные о примерно 10 миллионах поездок в Чикаго за 2022 и 2023 годы и перед нами стоит задача предсказать количество заказов на следующий час в каждом округе.

## Цели:
   * Развернуть вычислительный кластер PySpark на локальной машине с использованием Docker-контейнеров
   * Провести EDA, выявить и обработать аномалии
   * Провести feature-engineering для time-series данных
   * С помощью MLlib провести обучение нескольких моделей машинного обучения и предсказать количество заказов на следующий час для каждого района

## Метрики:
Бизнес метрика - минимальное время простоя машин такси в ожидании клиента, а также минимальное время простоя клиента в ожидании машины.
Бизнес метрика будет максимизирована если мы точно предскажем количество заказов для каждого округа, поэтому наша целевая метрика в задачах машинного обучения - MAE.
   
## Результаты:

Мы провели разведочный анализ данных, обработали пропуски и выбросы, а также некоторые аномальные значения. Посмотрели на распределения категориальных и численных данных. Провели предварительный feature-engineering, оценили feature-importance. Сделали порайонную агрегацию данных и добавили ряд дополнительных признаков, такие как лаги, скользящие средние, дни недели/месяца и т.д. Исследовали три вида моделей машинного обучения при помощи MLlib: LinearRegression, RandomForestRegressor, GBTRegressor.

Лучшие результаты были получены на модели градиентного бустинга. Эти модели были переучены на объединённых данных (train + valid) и протестированы на тестовой выборке для проверки адекватности результатов.

## Используемый стек

JupyterLab, PySpark, MLlib, Docker

Python - os, pandas, numpy, matplotlib, seaborn, statsmodels, tqdm
